# This file was auto-generated by the Firebase CLI
# https://github.com/firebase/firebase-tools

name: publish core package
on:
   push:
      branches:
         - main
      paths:
         - "packages/core/**"
defaults:
   run:
      working-directory: packages/core # Set the global working directory
jobs:
   build_and_publish:
      runs-on: ubuntu-latest
      steps:
         - name: Checkout code
           uses: actions/checkout@v4

         - name: Configure npm for authentication
           run: echo "//registry.npmjs.org/:_authToken=${NPM_TOKEN}" > ~/.npmrc
           env:
              NPM_TOKEN: ${{ secrets.NPM_TOKEN }}

         - name: Install dependencies
           run: yarn install --frozen-lockfile

         - name: Build the package
           run: yarn build

         - name: Publish to npm
           run: yarn publish --non-interactive
           env:
              NPM_TOKEN: ${{ secrets.NPM_TOKEN }}
              GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
